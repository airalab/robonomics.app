"use strict";(self["webpackChunkdapp_robonomics_network"]=self["webpackChunkdapp_robonomics_network"]||[]).push([[552],{39345:function(e,t,a){a.r(t),a.d(t,{default:function(){return j}});var l=a(56768);function n(e,t,a,n,o,s){const r=(0,l.g2)("robo-section"),u=(0,l.g2)("datalog-loader"),d=(0,l.g2)("robo-status"),i=(0,l.g2)("energy-chart"),c=(0,l.g2)("notice-text"),f=(0,l.g2)("robo-layout-section");return(0,l.uX)(),(0,l.Wv)(f,null,{default:(0,l.k6)((()=>[(0,l.bF)(r,{offset:"x2",width:"middle",style:{"text-align":"center"}},{default:(0,l.k6)((()=>t[0]||(t[0]=[(0,l.Lk)("h2",null,"Energy Monitor",-1)]))),_:1}),(0,l.bF)(r,{offset:"x2",width:"middle"},{default:(0,l.k6)((()=>[n.isFind?((0,l.uX)(),(0,l.Wv)(u,{key:0})):null===n.energyAddress?((0,l.uX)(),(0,l.Wv)(d,{key:1,type:"warning"},{default:(0,l.k6)((()=>t[1]||(t[1]=[(0,l.eW)(" Not found ")]))),_:1})):void 0!==n.energyAddress?((0,l.uX)(),(0,l.Wv)(i,{key:2,address:n.energyAddress},null,8,["address"])):(0,l.Q3)("",!0)])),_:1}),(0,l.bF)(r,{offset:"x2",width:"middle"},{default:(0,l.k6)((()=>[(0,l.bF)(c)])),_:1})])),_:1})}var o=a(17827),s=a(24275),r=a(76384);const u={key:0};function d(e,t,a,n,o,s){const r=(0,l.g2)("datalog-chart"),d=(0,l.g2)("sensor-info"),i=(0,l.g2)("last-data"),c=(0,l.g2)("datalog-loader");return n.isLaoded?((0,l.uX)(),(0,l.CE)("div",u,[(0,l.bF)(r,{log:n.log},null,8,["log"]),(0,l.bF)(d,{sensor_id:a.address,class:"block"},null,8,["sensor_id"]),(0,l.bF)(i,{data:n.log[n.log.length-1],class:"block"},null,8,["data"])])):((0,l.uX)(),(0,l.Wv)(c,{key:1}))}var i=a(90144),c=a(76543),f=a(29376);function g(e,t,a,n,o,s){const r=(0,l.g2)("chart");return(0,l.uX)(),(0,l.Wv)(r,{options:n.chartOptions,ref:"chart"},null,8,["options"])}a(44114),a(18111),a(7588);var v=a(75129),p={label:"Active power",unit:"W"},y={label:"Current",unit:"A"},h={label:"Energy today",unit:"kWh"},m={label:"Energy total",unit:"kWh"},b={label:"Voltage",unit:"V"},k={label:"Energy yesterday",unit:"kWh"},_={daily:h,voltage:b,active_power:p,yesterday_sum:k,current:y,total:m},w={components:{Chart:v.Chart},props:["log"],setup(e){const t=e=>{const t={};for(const a of e)for(const e of a.data)if(t[e.fullKey])t[e.fullKey].data.push([a.moment,parseFloat(e.value)]);else{let l=e.fullKey;_[e.fullKey]&&_[e.fullKey].label&&(l=_[e.fullKey].label),t[e.fullKey]={name:l,data:[[a.moment,parseFloat(e.value)]],tooltip:{valueSuffix:` ${_[e.fullKey].unit??""}`}}}return Object.values(t)},a=t(e.log);let n;return(0,l.sV)((()=>{n=(0,l.nI)().refs.chart.chart})),(0,l.wB)(e.log,(e=>{if(!n)return;const a=t(e);a.length>0&&(a.forEach((e=>{const t=n.series.findIndex((t=>t.name===e.name));t>=0?n.series[t].setData(e.data,!1):n.addSeries(e)})),n.redraw())})),{chartOptions:{lang:{locale:"en"},chart:{spacing:[50,20,20,20]},title:{text:""},time:{timezone:Intl.DateTimeFormat().resolvedOptions().timeZone},xAxis:{title:!1,type:"datetime",labels:{overflow:"justify",format:"{value: %H:%M }"}},yAxis:{title:!1},tooltip:{valueDecimals:2},series:a}}}},A=a(71241);const F=(0,A.A)(w,[["render",g]]);var x=F,L=a(24232);const W={class:"infoline flexline"},K={class:"infoline-info"};function C(e,t,a,n,o,s){return(0,l.uX)(),(0,l.CE)("section",null,[(0,l.Lk)("h3",null,"Last data "+(0,L.v_)(new Date(a.data.moment).toLocaleString()),1),(0,l.Lk)("div",W,[(0,l.Lk)("div",K,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(n.measurements,((e,t)=>((0,l.uX)(),(0,l.CE)("div",{class:"datalog-item",key:t},[(0,l.Lk)("b",null,(0,L.v_)(e.label)+":",1),(0,l.eW)(" "+(0,L.v_)(e.value),1)])))),128))])])])}function E(e){return _[e]||{label:e}}var X={props:["data"],setup(e){const t=[];for(const a of e.data.data){const e=E(a.fullKey);t.push({...e,value:`${e.calculate?e.calculate(a.value):a.value} ${e.unit??""}`})}return{measurements:t}}};const D=(0,A.A)(X,[["render",C],["__scopeId","data-v-0cba4dcc"]]);var I=D;const S=e=>{try{const t=[],a=JSON.parse(e);for(const e in a){const l=a[e];t.push({key:e,fullKey:e,value:l})}return t}catch(t){console.log(t)}};var O={props:["address"],components:{DatalogLoader:o.A,DatalogChart:x,SensorInfo:c.A,LastData:I},setup(e){const t=(0,f.c)((0,i.QW)(e).address,S),a=(0,i.KR)(!1),l=()=>{a.value=!a.value};return{log:t.log,isLaoded:t.isLaoded,isShowRaw:a,showRaw:l}}};const N=(0,A.A)(O,[["render",d],["__scopeId","data-v-2c9d01bc"]]);var R=N,V={props:["address"],components:{EnergyChart:R,DatalogLoader:o.A,NoticeText:s.A},setup(e){const{address:t,isFind:a,runFind:n}=(0,r.Z)("0x000000000000000000000000000000000000000000000000616c747275697374");return(0,l.wB)((()=>e.address),(e=>{e?t.value=e:n()}),{immediate:!0}),{energyAddress:t,isFind:a}}};const $=(0,A.A)(V,[["render",n]]);var j=$}}]);
//# sourceMappingURL=552.deefca98.js.map