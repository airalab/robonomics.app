(self["webpackChunkdapp_robonomics_network"]=self["webpackChunkdapp_robonomics_network"]||[]).push([[603],{16830:function(e,t,n){"use strict";var o=n(38250);t.jm=c,t.MX=s,t.$G=u;var r=o(n(37260)),a=o(n(32839));function i(e,t){for(let n of Object.keys(t))Object.prototype.hasOwnProperty.call(e,n)&&"object"===typeof t[n]?i(e[n],t[n]):e[n]=t[n];return e}function s(e){const t=Buffer.from(e.slice(2),"hex"),n=a.default.multihash.encode(t,"sha2-256"),o=new r.default(0,"dag-pb",n);return o.toString()}function c(e){return"0x"+Buffer.from(a.default.multihash.decode(new r.default(e).multihash).digest).toString("hex")}function u(e){const t=Buffer.from(e.toString(),"utf-8");if(t.length>32)throw new Error("max 32");const n=Buffer.alloc(32),o=Buffer.concat([n,t]),r=Buffer.from(o).slice(o.length-32,o.length);return"0x"+r.toString("hex")}function l(e){return Buffer.from(e.slice(2),"hex").toString()}},81422:function(e,t,n){"use strict";n.d(t,{HY:function(){return k},NU:function(){return f},OY:function(){return y},hZ:function(){return h},lJ:function(){return w},t8:function(){return v},um:function(){return g},wr:function(){return m}});n(46229),n(17330),n(62062),n(57658);var o=n(34321),r=n(87527),a=n(17349),i=n(15989),s=n(66842),c=n(16830),u=n(64188),l=n(98473);const d=(e,t,n)=>{const r=localStorage.getItem("rpc-parachain")||o.Z.default_rpc_endpoint;localStorage.setItem(`twins:${new URL(r).host}:${e}`,JSON.stringify({total:t,twins:n}))},w=e=>{const t=localStorage.getItem("rpc-parachain")||o.Z.default_rpc_endpoint;try{const n=JSON.parse(localStorage.getItem(`twins:${new URL(t).host}:${e}`));if(n)return n}catch(n){console.log(n)}return{total:!1,twins:[]}},f=async e=>await e.twin.getTotal(),p=async(e,t,n=0)=>{const o=[],r=await f(e);for(let a=n;a<r;a++){const n=await e.twin.getOwner(a);n===t&&o.push(a)}return{total:r,twins:o}},g=async(e,t)=>{const{total:n,twins:o}=await p(e,t);return d(t,n,o),o},k=e=>(e=e.replace(/^0x/,"").replace(/^00+/,""),e.length%2!==0&&(e="0"+e),Buffer.from(e,"hex").toString("utf8")),m=e=>(0,c.MX)(e);function v(e){const{getInstance:t}=(0,i.u)(),n=(0,u.iH)();return(0,l.YP)(e,(async e=>{if(e>=0){const o=t();n.value=await o.twin.getTwin(e)}}),{immediate:!0}),{twin:n}}function y(e=!1){const{isReady:t,getInstance:n}=(0,i.u)(),{account:o}=(0,r.m)(),a=(0,u.iH)([]),s=(0,u.iH)(!1),c=async e=>{const t=n(),o=w(e);let r=0;if(!1!==o.total){const e=await f(t);if(e===o.total)return void(a.value=o.twins);r=o.total}a.value=await g(t,e,r)},d=()=>{(0,l.YP)([o,t],(async([e,t])=>{e&&t&&(s.value=!0,await c(e),s.value=!1)}),{immediate:!0})};return e&&d(),{twins:a,isLoading:s,run:d}}function h(){const{getInstance:e}=(0,i.u)(),t=(0,s.a)(),{account:n}=(0,r.m)(),o=(0,a.L)(n),u=async()=>{const r=e(),a=r.twin.create(),i=t.createTx();return o.devices.value.includes(n.value)?await t.send(i,a,n.value):await t.send(i,a),i},l=async(r,a,i)=>{const s=e();let u;try{u=(0,c.jm)(a)}catch(w){u=(0,c.$G)(a)}const l=s.twin.setSource(r,u,i),d=t.createTx();return o.devices.value.includes(n.value)?await t.send(d,l,n.value):await t.send(d,l),d};return{create:u,setSource:l}}},69603:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return z}});var o=n(98473);const r=(0,o._)("h2",null,"Digital Twin",-1);function a(e,t,n,a,i,s){const c=(0,o.up)("robo-section"),u=(0,o.up)("d-twin"),l=(0,o.up)("robo-layout-section");return(0,o.wg)(),(0,o.j4)(l,null,{default:(0,o.w5)((()=>[(0,o.Wm)(c,{offset:"x2",width:"narrow",style:{"text-align":"center"}},{default:(0,o.w5)((()=>[r])),_:1}),(0,o.Wm)(c,{offset:"x2",width:"narrow"},{default:(0,o.w5)((()=>[(0,o.Wm)(u)])),_:1})])),_:1})}function i(e,t,n,r,a,i){const s=(0,o.up)("select-twin"),c=(0,o.up)("create-twin"),u=(0,o.up)("robo-grid"),l=(0,o.up)("robo-section"),d=(0,o.up)("twin-records"),w=(0,o.up)("form-source");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(l,{offset:"x05"},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{offset:"x0",gap:"x05",columns:"1"},{default:(0,o.w5)((()=>[((0,o.wg)(),(0,o.j4)(s,{onChange:t[0]||(t[0]=e=>r.twinId=e),key:r.keySelect})),(0,o.Wm)(c,{onCreate:t[1]||(t[1]=e=>r.keySelect++)})])),_:1})])),_:1}),r.twinId>=0?((0,o.wg)(),(0,o.j4)(l,{key:0,offset:"x2"},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{offset:"x0",gap:"x05",columns:"1"},{default:(0,o.w5)((()=>[((0,o.wg)(),(0,o.j4)(d,{id:r.twinId,key:r.keyRecords},null,8,["id"])),(0,o.Wm)(w,{id:r.twinId,onCreate:t[2]||(t[2]=e=>r.keyRecords++)},null,8,["id"])])),_:1})])),_:1})):(0,o.kq)("",!0)],64)}var s=n(64188);function c(e,t,n,r,a,i){const s=(0,o.up)("robo-button");return(0,o.wg)(),(0,o.j4)(s,{onClick:r.create,block:"",disabled:r.isProccess,loading:r.isProccess,type:r.isSuccess?"ok":"primary"},{default:(0,o.w5)((()=>[(0,o.Uk)(" Create new ")])),_:1},8,["onClick","disabled","loading","type"])}var u=n(81422),l={emits:["change"],setup(e,{emit:t}){const{create:n}=(0,u.hZ)(),o=(0,s.iH)(!1),r=(0,s.iH)(!1);return{isProccess:o,isSuccess:r,create:async()=>{r.value=!1,o.value=!0;const e=await n();if(e.error.value)return"Cancelled"!==e.error.value?console.log(e.error.value):console.log("cancel"),o.value=!1,!1;o.value=!1,r.value=!0,t("create")}}}},d=n(25312);const w=(0,d.Z)(l,[["render",c]]);var f=w;function p(e,t,n,r,a,i){const s=(0,o.up)("robo-text"),c=(0,o.up)("robo-input"),u=(0,o.up)("robo-button"),l=(0,o.up)("robo-grid"),d=(0,o.up)("robo-section");return(0,o.wg)(),(0,o.j4)(d,{offset:"x05"},{default:(0,o.w5)((()=>[(0,o.Wm)(l,{offset:"x0",gap:"x05",columns:"1"},{default:(0,o.w5)((()=>[(0,o.Wm)(s,{title:"3",offset:"x0"},{default:(0,o.w5)((()=>[(0,o.Uk)("Add source")])),_:1}),(0,o.Wm)(c,{modelValue:r.topic,"onUpdate:modelValue":t[0]||(t[0]=e=>r.topic=e),label:"Topic",block:""},null,8,["modelValue"]),(0,o.Wm)(c,{modelValue:r.source,"onUpdate:modelValue":t[1]||(t[1]=e=>r.source=e),label:"Source",block:""},null,8,["modelValue"]),(0,o.Wm)(u,{onClick:r.setSource,block:"",disabled:r.isProccess,loading:r.isProccess,type:r.isSuccess?"ok":"primary"},{default:(0,o.w5)((()=>[(0,o.Uk)(" Save ")])),_:1},8,["onClick","disabled","loading","type"])])),_:1})])),_:1})}var g={props:["id"],setup(e,{emit:t}){const{setSource:n}=(0,u.hZ)(),o=(0,s.iH)(),r=(0,s.iH)(),a=(0,s.iH)(!1),i=(0,s.iH)(!1);return{topic:o,source:r,isProccess:a,isSuccess:i,setSource:async()=>{i.value=!1,a.value=!0;const s=await n(e.id,o.value,r.value);if(s.error.value)return"Cancelled"!==s.error.value?console.log(s.error.value):console.log("cancel"),a.value=!1,!1;a.value=!1,i.value=!0,t("create")}}}};const k=(0,d.Z)(g,[["render",p]]);var m=k;function v(e,t,n,r,a,i){const s=(0,o.up)("robo-select"),c=(0,o.up)("robo-status"),u=(0,o.up)("robo-loader"),l=(0,o.up)("robo-text");return(0,o.wg)(),(0,o.iD)(o.HY,null,[r.twins.length>0?((0,o.wg)(),(0,o.j4)(s,{key:0,options:r.twins,values:r.twins,modelValue:r.twinId,"onUpdate:modelValue":t[0]||(t[0]=e=>r.twinId=e),size:"small",label:"Choose digital twin",block:""},null,8,["options","values","modelValue"])):((0,o.wg)(),(0,o.j4)(c,{key:1,type:"warning"},{default:(0,o.w5)((()=>[(0,o.Uk)("Digital twins do not exist")])),_:1})),r.isLoading?((0,o.wg)(),(0,o.j4)(l,{key:2,weight:"normal-italic",align:"center"},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{size:"1.5"}),(0,o.Uk)(" Loading ")])),_:1})):(0,o.kq)("",!0)],64)}var y={emits:["change"],setup(e,{emit:t}){const{twins:n,isLoading:r}=(0,u.OY)(!0),a=(0,s.iH)();return(0,o.YP)(n,(e=>{void 0===a.value&&(a.value=e[e.length-1])}),{immediate:!0}),(0,o.YP)(a,(e=>{t("change",e)})),{twins:n,twinId:a,isLoading:r}}};const h=(0,d.Z)(y,[["render",v]]);var b=h;const x={key:0};function _(e,t,n,r,a,i){const s=(0,o.up)("twin-record"),c=(0,o.up)("robo-status");return r.twin?((0,o.wg)(),(0,o.iD)("div",x,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(r.twin,((e,t)=>((0,o.wg)(),(0,o.j4)(s,{key:t,token:t,address:e},null,8,["token","address"])))),128))])):((0,o.wg)(),(0,o.j4)(c,{key:1,type:"warning"},{default:(0,o.w5)((()=>[(0,o.Uk)("No entries")])),_:1}))}var S=n(24887);const C={class:"record"},H={class:"type"},j={class:"token"},T={key:0},I={key:1},W={key:2};function U(e,t,n,r,a,i){const s=(0,o.up)("router-link");return(0,o.wg)(),(0,o.iD)("div",C,[(0,o._)("div",H,[(0,o._)("button",{class:(0,S.C_)({active:"hex"===r.type}),onClick:t[0]||(t[0]=e=>r.type="hex")}," hex ",2),(0,o._)("button",{class:(0,S.C_)({active:"ipfs"===r.type}),onClick:t[1]||(t[1]=e=>r.type="ipfs")}," ipfs ",2),(0,o._)("button",{class:(0,S.C_)({active:"text"===r.type}),onClick:t[2]||(t[2]=e=>r.type="text")}," text ",2)]),(0,o._)("div",j,["hex"===r.type?((0,o.wg)(),(0,o.iD)("span",T,(0,S.zw)(n.token),1)):(0,o.kq)("",!0),"ipfs"===r.type?((0,o.wg)(),(0,o.iD)("span",I,(0,S.zw)(r.tokenToCid(n.token)),1)):(0,o.kq)("",!0),"text"===r.type?((0,o.wg)(),(0,o.iD)("span",W,(0,S.zw)(r.tokenToString(n.token)),1)):(0,o.kq)("",!0)]),(0,o._)("div",null,(0,S.zw)(n.address),1),"0x000000000000000000000000000000000000000000000000616c747275697374"===n.token?((0,o.wg)(),(0,o.j4)(s,{key:0,to:`/altruist/${n.address}`},{default:(0,o.w5)((()=>[(0,o.Uk)(" Â» altruist ")])),_:1},8,["to"])):(0,o.kq)("",!0)])}var Y={props:["token","address"],setup(){const e=(0,s.iH)("hex");return{type:e,tokenToCid:u.wr,tokenToString:u.HY}}};const Z=(0,d.Z)(Y,[["render",U],["__scopeId","data-v-4d53ba22"]]);var D=Z,P={props:["id"],components:{TwinRecord:D},setup(e){const{twin:t}=(0,u.t8)((0,s.BK)(e).id);return{twin:t,tokenToCid:u.wr,tokenToString:u.HY}}};const B=(0,d.Z)(P,[["render",_]]);var V=B,L={components:{SelectTwin:b,CreateTwin:f,TwinRecords:V,FormSource:m},setup(){return{twinId:(0,s.iH)(),keySelect:(0,s.iH)(0),keyRecords:(0,s.iH)(0)}}};const O=(0,d.Z)(L,[["render",i]]);var R=O,$={components:{DTwin:R}};const q=(0,d.Z)($,[["render",a]]);var z=q},38250:function(e){function t(e){return e&&e.__esModule?e:{default:e}}e.exports=t,e.exports.__esModule=!0,e.exports["default"]=e.exports}}]);
//# sourceMappingURL=603.ce1ae116.js.map