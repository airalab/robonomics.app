(function(){var e={53675:function(e,t,a){"use strict";var n=a(77162),o=a(48046),r=a(29197),s=a(98473);function i(e,t,a,n,o,r){const i=(0,s.up)("router-view"),c=(0,s.up)("main-layout");return(0,s.wg)(),(0,s.j4)(c,{pagetitle:n.title},{default:(0,s.w5)((()=>[(0,s.Wm)(i)])),_:1},8,["pagetitle"])}function c(e,t,a,n,o,r){const i=(0,s.up)("dapp-header"),c=(0,s.up)("robo-layout");return(0,s.wg)(),(0,s.j4)(c,null,{default:(0,s.w5)((()=>[(0,s.Wm)(i,{title:a.pagetitle},null,8,["title"]),(0,s.WI)(e.$slots,"default")])),_:3})}function l(e,t,a,n,o,r){const i=(0,s.up)("robo-layout-header");return o.renderComponent?((0,s.wg)(),(0,s.j4)(i,{key:0,logoIcon:"images/icon_white.svg",navigation:o.navigation,title:a.title,version:o.version},null,8,["navigation","title","version"])):(0,s.kq)("",!0)}var u=a(55984),d=a.n(u);function p(e){return new(d())(e.toString())}function m(e,t){return p(e).todp(t)}function f(e,t=0,a){return p(e).div(new(d())(10).pow(t.toString())).todp(a).toString()}function v(){console.log("Build version:","master","v0.8.1","8bff777")}d().set({toExpNeg:-31,toExpPos:31});var w=a(65633),h=a(64188),g={props:{title:{type:String,default:"Robonomics Dapp"}},inject:["RobonomicsProvider"],data(){return{renderComponent:!0,navigation:[{title:"Services",links:[{title:"Sensors map",link:"https://sensors.robonomics.network",type:"external"}]},{title:"Tokenomics",links:[{title:"About XRT",link:"https://robonomics.network/xrt/",type:"external"},{title:"Uniswap",link:"https://app.uniswap.org/#/swap?inputCurrency=0x7de91b204c1c737bcee6f000aaa6569cf7061cb7&outputCurrency=0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2",type:"external"},{title:"Basilisk",link:"https://app.basilisk.cloud/pools-and-farms",type:"external"}]},{title:"Tools",links:[{title:"Substrate Portal",link:"https://polkadot.js.org/apps/?rpc=wss%3A%2F%2Fkusama.rpc.robonomics.network%2F#/explorer",type:"external"},{title:"Subscan",link:"https://robonomics.subscan.io/",type:"external"},{title:"Polkassembly",link:"https://robonomics.polkassembly.io/",type:"external"}]}],version:" "}},computed:{robonomics:function(){return(0,h.IU)(this.RobonomicsProvider.instance.value)}},watch:{"$store.state.robonomicsUIvue.polkadot.extensionObj":function(e){e.signer&&e.signer.signRaw&&this.$store.state.robonomicsUIvue.polkadot.address&&this.handlerAccount(this.$store.state.robonomicsUIvue.polkadot.address)},"$store.state.robonomicsUIvue.polkadot.address":{handler:function(e){e&&this.$store.state.robonomicsUIvue.polkadot.extensionObj.signer&&this.$store.state.robonomicsUIvue.polkadot.extensionObj.signer.signRaw&&this.handlerAccount(e)},immediate:!0},"RobonomicsProvider.isReady.value":{handler:function(e,t){e&&!t&&this.handlerAccount(this.$store.state.robonomicsUIvue.polkadot.address)},immediate:!0},$route:async function(){this.renderComponent=!1,await this.$nextTick(),this.renderComponent=!0}},async created(){try{const e=await w.Z.get("https://api.github.com/repos/airalab/dapp.robonomics.network/releases/latest");e.data.tag_name&&(this.version=e.data.tag_name)}catch(e){console.log("dApp version not found.")}},methods:{async handlerAccount(e){if(!this.RobonomicsProvider.isReady.value)return;this.unsubscribeBalance&&this.unsubscribeBalance();const t=this.$store.state.robonomicsUIvue.polkadot.accounts.find((t=>t.address===e));t&&("telemetry"!==this.$route.name&&await this.robonomics.accountManager.setSender(e,{type:t.type,extension:this.$store.state.robonomicsUIvue.polkadot.extensionObj}),this.unsubscribeBalance=await this.robonomics.account.getBalance(e,(e=>{const t=e.free.sub(e.frozen);this.$store.commit("polkadot/setBalanceXRT",m(f(t,this.robonomics.api.registry.chainDecimals[0]),4))})))}}},y=a(25312);const b=(0,y.Z)(g,[["render",l]]);var k=b,S=a(44406),_=a(76833),U=a(37695);function W(){const e=(0,s.f3)("RobonomicsProvider");return{accountManager:e.accountManager,isReady:e.isReady,robonomics:e.instance,getInstance:()=>e.instance.value}}const x=(e=null)=>{const{isReady:t,getInstance:a}=W(),n=(0,h.iH)(e),o=(0,h.iH)([]),r=async e=>{const n=localStorage.getItem("rpc-parachain")||"wss://kusama.rpc.robonomics.network/",o=`hadevices:${n}:${e}`;if(t.value)try{const t=await a().rws.getDevices(e),n=t.map((e=>e.toHuman()));return localStorage.setItem(o,JSON.stringify({time:Date.now(),value:n})),console.log("getDevices chain"),{data:n,cache:!1}}catch(r){console.log(r)}else{const e=localStorage.getItem(o);if(!e)return{data:[],cache:!0};try{const t=JSON.parse(e);return console.log("getDevices cache"),{data:t.value,cache:!0}}catch(r){console.log("hadevices bad",r)}}return{data:[],cache:!1}},i=async()=>{if(n.value)try{(0,U.Y)(n.value);const e=await r(n.value);if(o.value=e.data,e.cache){const e=(0,s.YP)(t,(async()=>{if(t.value){const t=await r(n.value);o.value=t.data,e()}}),{immediate:!0})}return}catch(e){console.log(e)}o.value=[]};return(0,s.YP)(n,(async()=>{await i()}),{immediate:!0}),(0,s.YP)(t,(async e=>{if(e){const e=await a().events.on({section:"rws",method:"NewDevices"},(async e=>{for(const t of e)t.data[0].toHuman()===n.value&&await i()}));(0,s.Ah)(e)}}),{immediate:!0}),{owner:n,devices:o,loadDevices:i}},I=()=>{const e=new S.P,t={PalletRobonomicsRwsSubscription:{_enum:{Lifetime:{tps:"Compact<u32>"},Daily:{days:"Compact<u32>"}}},PalletRobonomicsRwsSubscriptionLedger:{freeWeight:"Compact<u64>",issueTime:"Compact<u64>",lastUpdate:"Compact<u64>",kind:{_enum:{Lifetime:{tps:"Compact<u32>"},Daily:{days:"Compact<u32>"}}}}};return e.register(t),e},R=(e=null)=>{const t=(0,h.iH)(e),a=(0,h.XI)(null),{isReady:n,getInstance:o}=W(),{devices:r,loadDevices:i}=x(t),c=()=>o().api.consts.rws.referenceCallWeight,l=async e=>{const t=localStorage.getItem("rpc-parachain")||"wss://kusama.rpc.robonomics.network/",a=`hasubscription:${t}:${e}`;if(n.value){const t=await o().rws.getLedger(e);if(!t.isEmpty)return localStorage.setItem(a,JSON.stringify({time:Date.now(),value:t.value.toJSON()})),console.log("getLedger chain"),{data:t.value,cache:!1}}else{const e=localStorage.getItem(a);if(!e)return{data:void 0,cache:!0};try{const t=JSON.parse(e),a=(0,_.Z)(I(),"Option<PalletRobonomicsRwsSubscriptionLedger>",t.value);return console.log("getLedger cache"),{data:a.value,cache:!0}}catch(r){console.log("hasubscription bad",r)}}return{data:void 0,cache:!1}},u=864e5,d=async e=>{const t=(await l(e)).data;if(!t)return-1;const a=t.freeWeight.toNumber(),n=t.lastUpdate.toNumber(),o=t.issueTime.toNumber(),r=c(),s=Date.now();let i=(()=>{let e;if(t.kind.isLifetime)e=t.kind.value.tps.toNumber();else{const a=t.kind.value.days.toNumber(),n=a*u;e=s<o+n?1e4:0}return e})();const d=s-n;return Math.floor(a+r*i*d/1e9)},p=(0,s.Fl)((()=>{if(!a.value)return null;if(a.value.kind.isLifetime)return null;const e=a.value.issueTime.toNumber();let t=0;return a.value.kind.isDaily&&(t=a.value.kind.value.days.toNumber()),e+t*u})),m=(0,s.Fl)((()=>{if(!a.value)return 0;let e=0;return a.value.kind.isDaily&&(e=a.value.kind.value.days.toNumber()),e/30})),f=(0,s.Fl)((()=>!(!a.value||null!==p.value&&Date.now()>p.value))),v=(0,s.Fl)((()=>a.value)),w=async()=>{if(t.value)try{(0,U.Y)(t.value);const e=await l(t.value);if(a.value=e.data,e.cache){const e=(0,s.YP)(n,(async()=>{if(n.value){const n=await l(t.value);a.value=n.data,e()}}),{immediate:!0})}return}catch(e){console.log(e)}a.value=null};return(0,s.YP)(t,(async()=>{await w()}),{immediate:!0}),{owner:t,dataRaw:a,hasSubscription:v,isActive:f,countMonth:m,validUntil:p,loadLedger:w,devices:r,loadDevices:i,getFreeWeightCalc:d}};var A=a(90299),P={components:{DappHeader:k},props:["pagetitle"],setup(){const e=(0,A.oR)(),t=R();(0,s.YP)((()=>e.state.robonomicsUIvue.rws.active),(e=>{t.owner.value=e}),{immediate:!0}),(0,s.YP)([t.owner,t.validUntil],(()=>{e.commit("rws/setExpiredate",t.validUntil)}),{immediate:!0}),(0,s.YP)(t.devices,(t=>{e.commit("rws/setUsers",t)}),{immediate:!0})}};const O=(0,y.Z)(P,[["render",c]]);var C=O,M=a(94731),H={name:"App",components:{MainLayout:C},setup(){const e=(0,s.f3)("RobonomicsProvider"),t=(0,s.f3)("IpfsProvider"),a=(0,A.oR)(),n=(0,M.tv)(),o=(0,M.yj)(),r=(0,h.iH)();return a.commit("rws/setKey","88tHsnwjp*p36AurOu28W6UZz"),a.dispatch("rws/init"),a.commit("rws/setLinkActivate",n.resolve({name:"rwsActivate"}).path),a.commit("rws/setLinkSetup",n.resolve({name:"rwsSetup"}).path),a.commit("rws/setLinkSetupnew",n.resolve({name:"rwsSetupNew"}).path),a.commit("rws/setLinkDevices",n.resolve({name:"telemetry"}).path),a.commit("ipfs/setGateways",t.gateways),(0,s.YP)(o,(()=>{r.value=o?.meta?.title;const e=r.value?`${r.value} / Robonomics Dapp`:"Robonomics Dapp";document.title=e,document.querySelector('meta[property="og:title"]').setAttribute("content",e)})),(0,s.YP)([o,e.isReady],(([e,t])=>{"telemetry"!==e.name&&t&&(a.dispatch("app/setlibp2p",{connected:!1}),a.dispatch("app/setrelay",{connected:!1}))}),{immediate:!0}),{title:r}}};const N=(0,y.Z)(H,[["render",i]]);var $=N,j=(a(57658),a(66665));class T{constructor(e){this.endpoint=e,this.authHeader=null,this.robonomics=null,this._create()}_create(){this.client=(0,j.Ue)({...this._options()})}_options(){return{url:this.endpoint,headers:{authorization:`Basic ${this.authHeader}`,robonomics:this.robonomics}}}isAuth(){return!!this.authHeader&&!!this.robonomics}auth(e,t,a){const n=`sub-${t}:${a}`;this.authHeader=Buffer.from(n).toString("base64"),this.robonomics=e,this._create()}authClear(){this.authHeader=null,this.robonomics=null,this._create()}async ls(e){const t=[];for await(const a of this.client.ls(e))"file"===a.type&&t.push(a);return t}async cat(e){const t=async e=>{const t=new TextDecoder;let a="";for await(const n of this.client.cat(e))a+=t.decode(n,{stream:!0});return a};return await t(e)}async add(e){return await this.client.add(e)}async catViaGateway(e,t,a=5){for(let o=1;o<=a;o++)try{return(await w.Z.get(`${e}${t}`)).data}catch(n){console.log(n)}throw new Error("File not available")}async catViaGateways(e,t){for(const n of e)try{return{gateway:n,result:await this.catViaGateway(n,t)}}catch(a){console.log(a.message)}throw new Error("File not available")}}var D={install:(e,t)=>{const a=(0,h.iH)();e.provide("IpfsProvider",{instance:a,gateways:t.gateways||[]}),a.value=new T(t.api.gateway)}},E=(a(46229),a(17330),a(62062),a(11477)),Y=a(22971),L=a(63310),F=a(83830),z=a(5487),B=a(95241),K=a(76220),J=a(64560),Z=a(6627),G=a.n(Z),q=a(677),X=a.n(q);function V(e,t,a,n){return X().box.open(e,t,a,n)||null}function Q(e,t,a,n=(0,z.F)(24)){return{nonce:n,sealed:X().box(e,n,a,t)}}function ee(e){return G().convertSecretKey(e)}function te(e){return G().convertPublicKey(e)}function ae(e,t,a){const n=(0,L.Y)(e);return V(n.slice(24,n.length),n.slice(0,24),te((0,L.Y)(t)),ee(a))}function ne(e,t,a,n){const{nonce:o,sealed:r}=Q((0,L.Y)(e),ee(a),te((0,L.Y)(t)),n);return(0,F.e)(o,r)}function oe(e){const t=(0,B.S)(e),a=(0,K.U)(t);return a}function re(e){return{pair:e,address:(0,J.m)(e.publicKey,32),encodeAddress:(t=32)=>(0,J.m)(e.publicKey,t),decryptMessage:(t,a)=>ae(t,a,e.secretKey),encryptMessage:(t,a,n)=>ne(t,a,e.secretKey,n)}}var se=a(49021),ie=a(96134),ce=a(57898),le=a(54129);class ue extends Y.Uk{constructor(e,t={},a=null){super(e,a),this.extension=null,e.loadAll(t),this.setReady(!0)}async beforeSetSender(e,{type:t,extension:a}){this.extension=a;try{this.keyring.getPair(e)}catch(n){this.keyring.loadInjected(e,{},t)}}async afterSetSender(){await super.afterSetSender(),this.account.meta.isInjected&&this.extension&&(this.api.setSigner(this.extension.signer),this.account.signMsg=async e=>(await this.extension.signer.signRaw({address:this.account.address,data:(0,ie.c)((0,ce.Rl)(e)),type:"bytes"})).signature)}async addUri(e,t={},a="ed25519"){const n=this.keyring.keyring.addFromUri(e,t,a);return await this.setSender(n.address,{type:a})}async addUriPassword(e,t=void 0,a={},n="ed25519"){const{pair:o}=this.keyring.addUri(e,t,a,n);return await this.setSender(o.address,{type:n})}async addJsonPassword(e,t){const a=this.keyring.createFromJson(e);return this.keyring.addPair(a,t),await this.setSender(a.address,{type:a.type})}async addPair(e){const t=this.keyring.keyring.addFromPair(e);return await this.setSender(t.address,{type:t.type})}encryptor(e=null){if(!this.account.meta.isInjected&&"ed25519"===this.account.type){const t=this.account.toJson(e),a=(0,se.M)(e,(0,le.tV)(t.encoded),t.encoding.type);return re(a)}}}var de={install:async(e,t={})=>{const a=(0,h.iH)(!1),n=(0,h.XI)(),o=new ue(E.ZP);e.provide("RobonomicsProvider",{isReady:a,instance:n,accountManager:o});const r=new URLSearchParams(window.location.search);let s=r.get("rpc");s||(s=localStorage.getItem("rpc-parachain")||"wss://kusama.rpc.robonomics.network/"),localStorage.setItem("rpc-parachain",s);const i={endpoint:s};n.value=await Y.l.createInstance({...i,...t}),n.value.setAccountManager(o),a.value=!0}},pe=a(24887);const me=(0,s._)("b",null,"~ 2 min",-1),fe=(0,s._)("span",null,"What is Robonomics",-1),ve=(0,s._)("span",null,"Step-by-step tutorials",-1),we=(0,s._)("span",null,"Advanced cources",-1);function he(e,t,a,n,o,r){const i=(0,s.up)("robo-template-rws-active"),c=(0,s.up)("robo-text"),l=(0,s.up)("robo-icon"),u=(0,s.up)("robo-link"),d=(0,s.up)("robo-grid"),p=(0,s.up)("robo-details"),m=(0,s.up)("robo-grid-item"),f=(0,s.up)("robo-section"),v=(0,s.up)("robo-button"),w=(0,s.up)("robo-card"),h=(0,s.up)("robo-layout-section");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(h,{width:"middle-wide"},{default:(0,s.w5)((()=>[(0,s.Wm)(d,{offset:"x0",minColumnWidth:"200px"},{default:(0,s.w5)((()=>[(0,s.Wm)(f,{offset:"x0"},{default:(0,s.w5)((()=>[(0,s.Wm)(w,null,{default:(0,s.w5)((()=>[n.rwsactive&&""!==n.rwsactive?((0,s.wg)(),(0,s.j4)(i,{key:0})):((0,s.wg)(),(0,s.iD)(s.HY,{key:1},[(0,s.Wm)(c,{title:"4",align:"left"},{default:(0,s.w5)((()=>[(0,s.Uk)("RWS subscription")])),_:1}),(0,s.Wm)(f,{offset:"x1"},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{size:"small",weight:"normal-italic"},{default:(0,s.w5)((()=>[(0,s.Wm)(d,{offset:"x0",gap:"x05",columns:"1"},{default:(0,s.w5)((()=>[(0,s.Wm)(m,{borderbottom:""},{default:(0,s.w5)((()=>[(0,s.Uk)(" Price from: "),(0,s._)("b",null,"~ "+(0,pe.zw)(n.price)+" XRT ",1),(0,s.Wm)(p,null,{summary:(0,s.w5)((()=>[(0,s.Wm)(l,{icon:"circle-question"})])),default:(0,s.w5)((()=>[(0,s.Wm)(d,{offset:"x0",gap:"x05"},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{weight:"bold"},{default:(0,s.w5)((()=>[(0,s.Uk)("Where to buy XRT")])),_:1}),(0,s.Wm)(u,{href:"https://app.basilisk.cloud/trade"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Basilisk ")])),_:1}),(0,s.Wm)(u,{href:"https://app.solarbeam.io/exchange/swap"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Solarbeam ")])),_:1}),(0,s.Wm)(u,{href:"https://trade.kraken.com/markets/kraken/xrt/usd"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Kraken ")])),_:1})])),_:1})])),_:1})])),_:1}),(0,s.Wm)(m,{borderbottom:""},{default:(0,s.w5)((()=>[(0,s.Uk)(" Activation time "),me])),_:1}),(0,s.Wm)(m,null,{default:(0,s.w5)((()=>[(0,s.Uk)(" Available subscriptions: "),(0,s._)("b",null,(0,pe.zw)(n.freeAuctions),1)])),_:1})])),_:1})])),_:1})])),_:1}),(0,s.Wm)(v,{router:n.linkActivate,size:"small"},{default:(0,s.w5)((()=>[(0,s.Wm)(l,{icon:"wallet"}),(0,s.Uk)(" Buy a subscription ")])),_:1},8,["router"])],64))])),_:1})])),_:1}),(0,s.Wm)(f,{offset:"x0"},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{title:"4",align:"left"},{default:(0,s.w5)((()=>[(0,s.Uk)("What you get with RWS")])),_:1}),(0,s.Wm)(c,{size:"small",weight:"normal-italic"},{default:(0,s.w5)((()=>[(0,s.Wm)(d,{offset:"x0",gap:"x05",columns:"1"},{default:(0,s.w5)((()=>[(0,s.Wm)(m,{borderbottom:""},{default:(0,s.w5)((()=>[(0,s.Wm)(l,{icon:"check"}),(0,s.Uk)(" Brand-independent smart home ")])),_:1}),(0,s.Wm)(m,{borderbottom:""},{default:(0,s.w5)((()=>[(0,s.Wm)(l,{icon:"check"}),(0,s.Uk)(" Secured data, only you have access ")])),_:1}),(0,s.Wm)(m,{borderbottom:""},{default:(0,s.w5)((()=>[(0,s.Wm)(l,{icon:"check"}),(0,s.Uk)(" Remote control without corporate clouds ")])),_:1}),(0,s.Wm)(m,null,{default:(0,s.w5)((()=>[(0,s.Wm)(l,{icon:"check"}),(0,s.Uk)(" Home assistant integration ")])),_:1})])),_:1})])),_:1})])),_:1}),(0,s.Wm)(f,{offset:"x0"},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{title:"4",align:"left"},{default:(0,s.w5)((()=>[(0,s.Uk)("What is RWS")])),_:1}),(0,s.Wm)(c,{weight:"normal-italic",size:"small",offset:"x1"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Robonomics Web Services (RWS) is a smart home integration that enables secure interaction with smart devices and robots through transactions on the Robonomics parachain, rather than relying on centralized cloud services. ")])),_:1}),(0,s.Wm)(c,{weight:"normal-italic",size:"small",offset:"x1"},{default:(0,s.w5)((()=>[(0,s.Uk)(" An RWS subscription ensures stable transaction processing with every block, making it an ideal choice for those who wish to receive data from devices and remotely manage them. ")])),_:1}),(0,s.Wm)(c,{weight:"normal-italic",size:"small",offset:"x1"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Easy to start for Home Assistant users. "),(0,s.Wm)(u,{href:"https://wiki.robonomics.network/docs/install-smart-home/"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Guide to start ")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),(0,s.Wm)(h,null,{default:(0,s.w5)((()=>[(0,s.Wm)(d,{id:"home-links",offset:"x0",columns:3,gap:"x05"},{default:(0,s.w5)((()=>[(0,s.Wm)(u,{href:"https://www.youtube.com/watch?v=onMv_An8h2Q"},{default:(0,s.w5)((()=>[fe])),_:1}),(0,s.Wm)(u,{href:"https://wiki.robonomics.network"},{default:(0,s.w5)((()=>[ve])),_:1}),(0,s.Wm)(u,{href:"https://robonomics.academy"},{default:(0,s.w5)((()=>[we])),_:1})])),_:1})])),_:1})],64)}var ge=a(95496),ye={setup(){const e=(0,h.iH)(0),t=(0,h.iH)(0);let a=null;const n=(0,A.oR)(),o=(0,s.Fl)((()=>n.state.robonomicsUIvue.rws.active)),r=(0,s.Fl)((()=>n.state.robonomicsUIvue.rws.links.activate)),{isReady:i,getInstance:c}=W();(0,s.YP)(i,(async n=>{if(n){const n=c();t.value=(await n.rws.getAuctionQueue()).length,a=await n.events.onBlock((async()=>{t.value=(await n.rws.getAuctionQueue()).length}));const o=await n.rws.getMinimalBid();e.value=o.add((0,ge.G)(1))}}),{immediate:!0}),(0,s.Ah)((()=>{a&&a()}));const l=(0,s.Fl)((()=>i.value?f(e.value,c().api.registry.chainDecimals[0],0):0));return{rwsactive:o,linkActivate:r,freeAuctions:t,price:l}}};const be=(0,y.Z)(ye,[["render",he]]);var ke=be,Se={created:function(){window.location.href=`https://v0.dapp.robonomics.network/${this.$route.href}`}};const _e=Se;var Ue=_e;function We(e,t,a,n,o,r){const i=(0,s.up)("robo-template-rws-buy"),c=(0,s.up)("robo-layout-section");return(0,s.wg)(),(0,s.j4)(c,null,{default:(0,s.w5)((()=>[(0,s.Wm)(i,{price:n.price,activationtime:"2",available:n.freeAuctions,chainInfoUploaded:n.chainInfoStatus,rwsExpiration:n.expiredate,onOnActivate:n.onActivate},null,8,["price","available","chainInfoUploaded","rwsExpiration","onOnActivate"])])),_:1})}const xe=()=>{const e=(0,h.iH)(null),{accountManager:t}=W();t.account&&(e.value=t.account.address);const a=t.onChange((t=>{e.value=t.address}));return{account:e,unsubscribe:a}},Ie=e=>{const t=(0,h.iH)(null),{isReady:a,getInstance:n}=W();let o;return(0,s.YP)([e,a],(async()=>{if(o&&o(),!a.value)return;const r=n();o=await r.account.getBalance(e.value,(e=>{t.value=e.free.sub(e.frozen).toNumber()}))})),{balance:t,unsubscribe:o}},Re=()=>{const{isReady:e,getInstance:t,accountManager:a}=W(),{getFreeWeightCalc:n}=R(),o=async(e,t)=>{if(!t){if(!a.account)throw new Error("Signer required");t=a.account.address}return e.hasPaymentInfo?(await e.paymentInfo(t)).weight.toNumber():0},r=async(e,t)=>{const a=await n(t);if(a<0)throw new Error(`Not found ledger ${t}`);const r=await o(e);if(r>a)throw new Error(`The origin account have no enough free weight to process these call. Call weight ${r}, Free weight ${a}`)},s=()=>{const e=(0,h.iH)(null),t=(0,h.iH)(null),a=(0,h.iH)(!1);return{error:t,process:a,result:e}},i=async(a,n,o=!1)=>{if(a.result.value=null,a.error.value=null,a.process.value=!0,!e.value)return a.error.value="Robonomics is not ready",void(a.process.value=!1);const s=t();try{o&&(await r(n,o),s.accountManager.useSubscription(o));const e=await s.api.rpc.system.accountNextIndex(s.accountManager.account.address);a.result.value=await s.accountManager.signAndSend(n,{nonce:e}),console.log("tx",a.result.value.block,a.result.value.tx)}catch(i){console.log(i),a.error.value=i.message}return a.process.value=!1,o&&s.accountManager.useSubscription(!1),a.result};return{createTx:s,send:i}};var Ae={setup(){const e=(0,h.iH)(0),t=(0,h.iH)(0),a=(0,h.iH)(!1);let n=null;const{isReady:o,getInstance:r}=W(),{account:i,unsubscribe:c}=xe(),{balance:l,unsubscribe:u}=Ie(i),d=R(i),p=x(i);(0,s.YP)(o,(async o=>{if(o){const o=r();t.value=(await o.rws.getAuctionQueue()).length,n=await o.events.onBlock((async()=>{t.value=(await o.rws.getAuctionQueue()).length}));const s=await o.rws.getMinimalBid();e.value=s.add((0,ge.G)(1)),a.value=!0}}),{immediate:!0}),(0,s.Ah)((()=>{n&&n(),u&&u(),c()}));const m=Re(),v=async a=>{if(!o.value)return void a("error","Parachain is not ready.");if(!l.value||(0,ge.G)(l.value).lt(e.value.add((0,ge.G)(1e7))))return void a("error","Subscription can not be activated due to unsuffcicient XRT balance");if(t.value<=0)return void a("error","There are no available subscriptions");if(d.hasSubscription.value&&d.isActive.value)return void a("error","You have an active subscription");const n=r();let c=n.rws.bid(Number(await n.rws.getFirtsFreeAuction()),e.value);p.devices.value.includes(i.value)||(c=n.api.tx.utility.batch([c,n.rws.setDevices([...p.devices.value,i.value])]));const u=m.createTx();if(await m.send(u,c),u.error.value)return void("Cancelled"!==u.error.value?a("error",u.error.value):a("cancel"));const f=await n.events.onBlock((()=>{d.loadLedger()})),v=(0,s.m0)((()=>{d.hasSubscription.value&&d.isActive.value&&(v(),f(),a("ok"))}))},w=(0,s.Fl)((()=>o.value?f(e.value,r().api.registry.chainDecimals[0],0):0));return{freeAuctions:t,price:w,expiredate:d.validUntil,chainInfoStatus:a,onActivate:v}}};const Pe=(0,y.Z)(Ae,[["render",We]]);var Oe=Pe;function Ce(e,t,a,n,o,r){const i=(0,s.up)("robo-template-rws-setup"),c=(0,s.up)("robo-layout-section");return(0,s.wg)(),(0,s.j4)(c,null,{default:(0,s.w5)((()=>[(0,s.Wm)(i,{onRwsUpdate:n.rwsUpdateActions,onUserDelete:n.removeUser,onUserAdd:n.addUser,onSaveHapass:n.saveHapass},null,8,["onRwsUpdate","onUserDelete","onUserAdd","onSaveHapass"])])),_:1})}var Me=a(26444),He={setup(){const e=(0,A.oR)(),t=(0,s.Fl)((()=>e.state.robonomicsUIvue.rws.active)),{isReady:a,getInstance:n}=W(),o=Re(),r=x(t),{account:i}=xe(),c=(e,t)=>{if(e.owner&&e.name&&e.controller){try{(0,J.m)(e.owner)}catch(a){return void t("error",`Owner: ${a.message}`)}try{(0,J.m)(e.controller)}catch(a){return void t("error",`Controller: ${a.message}`)}t("ok")}else t("error","All fields are required")},l=async(s,c)=>{if(a.value)if(t.value&&t.value!==i.value)c("error","You do not have access to this action.");else{if(!r.devices.value.includes(s)){const e=await n().rws.setDevices([...r.devices.value,s]),a=o.createTx();if(r.devices.value.includes(i.value)?await o.send(a,e,t.value):await o.send(a,e),a.error.value)return void("Cancelled"!==a.error.value?c("error",a.error.value):c("cancel"));await r.loadDevices()}e.commit("rws/setUsers",r.devices),c("ok")}else c("error","Parachain is not ready.")},u=async(s,c)=>{if(a.value)if(t.value&&t.value!==i.value)c("error","You do not have access to this action.");else{if(r.devices.value.includes(s)){const e=await n().rws.setDevices(r.devices.value.filter((e=>e!==s))),a=o.createTx();if(r.devices.value.includes(i.value)?await o.send(a,e,t.value):await o.send(a,e),a.error.value)return void("Cancelled"!==a.error.value?c("error",a.error.value):c("cancel"));await r.loadDevices()}e.commit("rws/setUsers",r.devices),c("ok")}else c("error","Parachain is not ready.")},d=async(s,i)=>{if(!a.value)return void i("error","Parachain is not ready.");const c=e.state.robonomicsUIvue.rws.user.account,l=n();await l.accountManager.addPair(e.state.robonomicsUIvue.rws.user.key);const u=l.accountManager.encryptor();try{(0,J.m)(c)}catch(g){return void i("error",g.message)}const d=r.devices.value.map((e=>(0,J.m)(e)));if(!d.includes((0,J.m)(c)))return void i("error","User not found in subscription");const p=e.state.robonomicsUIvue.rws.list.find((e=>e.owner===t.value)),m=u.encryptMessage(s,(0,Me.m)(p.controller)),f=u.encryptMessage(s,(0,Me.m)(c)),v=await l.datalog.write(JSON.stringify({subscription:p.owner,ha:p.controller,admin:(0,ie.c)(m),user:(0,ie.c)(f)})),w=o.createTx();await o.send(w,v,p.owner);const h=e.state.robonomicsUIvue.polkadot.accounts.find((t=>t.address===e.state.robonomicsUIvue.polkadot.address));h&&await l.accountManager.setSender(h.address,{type:h.type,extension:e.state.robonomicsUIvue.polkadot.extensionObj}),w.error.value?"Cancelled"!==w.error.value?i("error",w.error.value):i("cancel"):i("ok")};return{saveHapass:d,rwsUpdateActions:c,addUser:l,removeUser:u}}};const Ne=(0,y.Z)(He,[["render",Ce]]);var $e=Ne;function je(e,t,a,n,o,r){const i=(0,s.up)("robo-template-rws-setup"),c=(0,s.up)("robo-layout-section");return(0,s.wg)(),(0,s.j4)(c,null,{default:(0,s.w5)((()=>[(0,s.Wm)(i,{create:"",onRwsUpdate:n.onSave},null,8,["onRwsUpdate"])])),_:1})}var Te={setup(){let e=(e,t)=>{if(e.owner&&e.name&&e.controller){try{(0,J.m)(e.owner)}catch(a){return void t("error",`Owner: ${a.message}`)}try{(0,J.m)(e.controller)}catch(a){return void t("error",`Controller: ${a.message}`)}t("ok")}else t("error","All fields are required")};return{onSave:e}}};const De=(0,y.Z)(Te,[["render",je]]);var Ee=De;function Ye(e,t){const a=(0,s.up)("robo-image"),n=(0,s.up)("robo-link"),o=(0,s.up)("robo-text"),r=(0,s.up)("robo-card"),i=(0,s.up)("robo-grid"),c=(0,s.up)("robo-layout-section");return(0,s.wg)(),(0,s.j4)(c,null,{default:(0,s.w5)((()=>[(0,s.Wm)(i,{offset:"x0",gap:"x1",galign:"start",minColumnWidth:"450px"},{default:(0,s.w5)((()=>[(0,s.Wm)(r,null,{default:(0,s.w5)((()=>[(0,s.Wm)(n,{router:"/telemetry"},{default:(0,s.w5)((()=>[(0,s.Wm)(a,{src:"images/services-ha.jpg"})])),_:1}),(0,s.Wm)(o,{title:"3"},{default:(0,s.w5)((()=>[(0,s.Wm)(n,{router:"/telemetry"},{default:(0,s.w5)((()=>[(0,s.Uk)("Home assistant")])),_:1})])),_:1}),(0,s.Wm)(o,{size:"small"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Integrate Robonomics into your Home assistant dashboard and get Parachain decentralized cloud service all over the word. Manipulate your smart devices bypassing corporate clouds, manage user access wherever you are. Backup your smart home data in blockchain. ")])),_:1})])),_:1}),(0,s.Wm)(r,null,{default:(0,s.w5)((()=>[(0,s.Wm)(n,{href:"https://sensors.robonomics.network/#/"},{default:(0,s.w5)((()=>[(0,s.Wm)(a,{src:"images/services-sensors.jpg"})])),_:1}),(0,s.Wm)(o,{title:"3"},{default:(0,s.w5)((()=>[(0,s.Wm)(n,{href:"https://sensors.robonomics.network/#/"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Sensors Map ")])),_:1})])),_:1}),(0,s.Wm)(o,{size:"small"},{default:(0,s.w5)((()=>[(0,s.Uk)(" The decentralized opensource sensors map offers two distinct layers of decentralization at your choise: peer-to-peer connectivity for direct access to sensor data, and the federative concept for accumulating sensor data and displaying measurement history. Anyone can assemble your own sensor using components available on the free market. ")])),_:1})])),_:1}),(0,s.Wm)(r,null,{default:(0,s.w5)((()=>[(0,s.Wm)(n,{href:"https://dapp.spot-sdk.education"},{default:(0,s.w5)((()=>[(0,s.Wm)(a,{src:"images/services-spot.jpg"})])),_:1}),(0,s.Wm)(o,{title:"3"},{default:(0,s.w5)((()=>[(0,s.Wm)(n,{href:"https://dapp.spot-sdk.education"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Boston Dynamics Spot SDK lessons ")])),_:1})])),_:1}),(0,s.Wm)(o,{size:"small"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Learn and practice with the Boston Dynamics Spot robot wherever you are. After each lesson you will receive a captured video of the robot movements and a printable PDF certificate. ")])),_:1})])),_:1}),(0,s.Wm)(r,null,{default:(0,s.w5)((()=>[(0,s.Wm)(n,{href:"https://telescope.merklebot.com/#/"},{default:(0,s.w5)((()=>[(0,s.Wm)(a,{src:"images/services-telescope.jpg"})])),_:1}),(0,s.Wm)(o,{title:"3"},{default:(0,s.w5)((()=>[(0,s.Wm)(n,{href:"https://telescope.merklebot.com/#/"},{default:(0,s.w5)((()=>[(0,s.Uk)(" An Autonomous Telescope Minting RMRK NFT's ")])),_:1})])),_:1}),(0,s.Wm)(o,{size:"small"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Connect to an autonomous telescope in the dark night of the Atacama desert in Chile to capture an astronomical object and mint unique NFTs in a few clicks. ")])),_:1})])),_:1}),(0,s.Wm)(r,null,{default:(0,s.w5)((()=>[(0,s.Wm)(n,{href:"https://dapp.ipci.io/#/offsetting"},{default:(0,s.w5)((()=>[(0,s.Wm)(a,{src:"images/services-offsetting.jpg"})])),_:1}),(0,s.Wm)(o,{title:"3"},{default:(0,s.w5)((()=>[(0,s.Wm)(n,{href:"https://dapp.ipci.io/#/offsetting"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Smart Building Offsetting ")])),_:1})])),_:1}),(0,s.Wm)(o,{size:"small"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Carbon footprint clearance for smart buildings based on geolocation and energy consumption information. ")])),_:1})])),_:1})])),_:1})])),_:1})}const Le={},Fe=(0,y.Z)(Le,[["render",Ye]]);var ze=Fe;function Be(e,t,a,n,o,r){const i=(0,s.up)("Libp2p"),c=(0,s.up)("Launch");return"libp2p"===n.type?((0,s.wg)(),(0,s.j4)(i,{key:0,config:n.config,isKey:n.isKey,onConnected:n.handlerConnected,onError:n.handlerError},null,8,["config","isKey","onConnected","onError"])):((0,s.wg)(),(0,s.j4)(c,{key:1,config:n.config,isKey:n.isKey},null,8,["config","isKey"]))}function Ke(e,t,a,n,o,r){const i=(0,s.up)("robo-template-devices-layout");return(0,s.wg)(),(0,s.j4)(i,{config:a.config,datalog:n.data,updateTime:n.updateTime},null,8,["config","datalog","updateTime"])}function Je(){const{account:e}=xe(),{instance:t}=(0,s.f3)("IpfsProvider");return(0,s.YP)(e,(async()=>{t.value&&t.value.authClear()})),t.value}var Ze=a(82760);const Ge=e=>e.replaceAll("'",'"').replaceAll("\\","").replaceAll('""','"').replaceAll("True","true").replaceAll("False","false").replaceAll("None",'"None"'),qe=e=>{try{return JSON.parse(e)}catch(t){console.log("error parse 1")}try{return JSON.parse(Ge(e))}catch(t){console.log("error parse 2"),console.log(e)}return!1},Xe=async(e,t)=>{const a=await e.datalog.getLastId(t);return a.id},Ve=async(e,t)=>{if(console.log("getLastDatalog"),!t)return!1;const a=await Xe(e,t);if(null!==a&&a>=0){const n=await e.datalog.readByIndex(t,a);return{timestamp:n[0].toNumber(),cid:(0,Ze.z)(n[1])}}return!1},Qe=async(e,t,a)=>{if(console.log("getConfigCid"),!t||!a)return!1;const n=await e.twin.getTwin(a);if(!n)return!1;const o=Object.keys(n).find((e=>n[e]===t));return!!o&&Y.P6.hexToCid(o)};var et=a(38537),tt=a(78434);const at=async(e,t,a)=>{if(!a)return!1;try{return await t.catViaGateway(e.state.robonomicsUIvue.ipfs.activegateway,a,2)}catch(n){try{const n=await t.catViaGateways(e.state.robonomicsUIvue.ipfs.gateways,a);return e.commit("ipfs/setActiveGateway",n.gateway),n.result}catch(o){console.log(o.message)}}return!1},nt=async(e,t,a)=>{if(e)try{const n=(0,Me.m)(t),o=a.decryptMessage((0,tt.G)(e[a.address]),n),r=re(oe((0,Ze.z)(o))),s=r.decryptMessage((0,tt.G)(e.data),n);return qe((0,Ze.z)(s))}catch(n){console.log(n.message)}return!1},ot=async(e,t,a,n,o)=>{if(e){const r=await at(n,o,e);if(!r)return console.log(`Error: ${e} not found in ipfs`),null;const s=await nt(r,t,a);if(s)return s;console.log("Error: decryptMsg")}return null},rt=e=>{if(e.state.robonomicsUIvue.rws.active){const a=e.state.robonomicsUIvue.rws.list.find((t=>t.owner===e.state.robonomicsUIvue.rws.active));if(a)try{return{controller:a.controller,owner:a.owner}}catch(t){console.log(t)}}return!1},st=()=>{const e=(0,h.iH)(null),t=(0,h.iH)(null),a=(0,A.oR)();return(0,s.YP)((()=>a.state.robonomicsUIvue.rws.active),(()=>{const n=rt(a);n&&(e.value=n.controller,t.value=n.owner)}),{immediate:!0}),{controller:e,owner:t}},it=(e,t,a=3e3)=>{e.dispatch("app/setStatus",{value:t,timeout:a}),console.log(t)},ct=(e,t,a)=>{e.commit("rws/setLaunch",JSON.stringify({...t,tx:{tx_status:a}}))},lt=()=>{const e=(0,h.iH)(null),t=(0,A.oR)(),a=Je(),{isReady:n,getInstance:o,accountManager:r}=W(),{controller:i}=st(),c=async e=>{const s=localStorage.getItem("rpc-parachain")||"wss://kusama.rpc.robonomics.network/",i=`haconfig:${s}:${e}`;if(n.value){const n=o(),s=await Ve(n,e),c=await ot(s.cid,e,r.encryptor(),t,a);if(c){const o=c.twin_id;it(t,`Twin id #${o}`),it(t,"Start load config");const s=await Qe(n,e,o);s||(console.log("Config not found"),console.log("controller",e),console.log("twin_id",o));const l=await ot(s,e,r.encryptor(),t,a);return localStorage.setItem(i,JSON.stringify({time:Date.now(),value:l})),console.log("getConfig chain"),{data:l,cache:!1}}}else{const e=localStorage.getItem(i);if(!e)return{data:null,cache:!0};try{const t=JSON.parse(e);return console.log("getConfig cache"),{data:t.value,cache:!0}}catch(c){console.log("haconfig bad",c)}}return{data:null,cache:!1}},l=async()=>{if(it(t,"Find twin id"),!i.value||!r.account||"ed25519"!==r.account.type)return void it(t,"Error");const a=await c(i.value);if(e.value=a.data,a.cache){const t=(0,s.YP)(n,(async()=>{if(n.value){const a=await c(i.value);e.value=a.data,t()}}),{immediate:!0})}null!==e.value&&it(t,"Config loaded")};return{config:e,load:l}},ut=()=>{const e=(0,h.iH)(null),t=(0,h.iH)(null),a=(0,h.iH)(null),n=(0,A.oR)(),o=Je(),{isReady:r,getInstance:i,accountManager:c}=W(),l=Re(),u=x(),{controller:d,owner:p}=st();let m;(0,s.YP)((()=>n.state.robonomicsUIvue.rws.active),(()=>{u.owner.value=n.state.robonomicsUIvue.rws.active}),{immediate:!0});const f=async()=>{r.value&&(m=await i().datalog.on({method:"NewRecord"},(a=>{const n=a.filter((e=>e.success&&d.value&&e.data[0].toHuman()===d.value));for(const o of n)t.value=o.data[1].toNumber(),e.value=o.data[2].toHuman()})))};(0,s.YP)(e,(async()=>{a.value=await ot(e.value,d.value,c.encryptor(),n,o)}));const v=async()=>{if(r.value&&d.value){const a=await Ve(i(),d.value);e.value=a.cid,t.value=a.timestamp}f()},w=()=>{m&&m()};(0,s.Ah)((()=>{console.log("unmount launch"),w()}));const g=async e=>{if(console.log(e.launch.params.entity_id,e.tx.tx_status),"pending"!==e.tx.tx_status)return;if(it(n,"Launch command"),console.log(`command ${JSON.stringify(e)}`),!u.devices.value.includes(c.account.address))return it(n,"Error: You do not have access to device management."),void ct(n,e,"error");if(!o.isAuth()){it(n,"Authorization on ipfs node");try{const e=(await c.account.signMsg((0,et.d)(c.account.address))).toString();o.auth(p.value,c.account.address,e)}catch(v){return void("Cancelled"===v.message?ct(n,e,"declined"):(console.log(v),ct(n,e,"error")))}ct(n,e,"approved")}const t=c.encryptor(),a=(0,Me.m)(d.value);let s;try{const n=JSON.stringify(e.launch),r=t.encryptMessage(n,a);s=await o.add((0,ie.c)(r))}catch(v){return ct(n,e,"error"),void it(n,`Error: ${v.message}`)}if(console.log(`launch ipfs file ${s.path}`),!r.value)return it(n,"Error: Robonomics is not ready."),void ct(n,e,"error");it(n,"Send launch");const m=i().launch.send(d.value,s.path),f=l.createTx();await l.send(f,m,p.value),f.error.value?"Cancelled"!==f.error.value?(ct(n,e,"error"),it(n,`Error: ${f.error.value}`)):(ct(n,e,"declined"),it(n,"Calcel")):(console.log(e),ct(n,e,"success"),it(n,"Launch sended"))};return{cid:e,updateTime:t,data:a,run:v,stop:w,launch:g}};var dt={props:{isKey:{default:!1,type:Boolean},config:{default:null,type:Object}},setup(e){const{data:t,updateTime:a,run:n,launch:o}=ut(),r=(0,A.oR)();return(0,s.YP)((()=>e.isKey),(e=>{e&&n()}),{immediate:!0}),(0,s.YP)((()=>r.state.robonomicsUIvue.rws.launch),(e=>{try{o(JSON.parse(e))}catch(t){console.log(t)}})),{data:t,updateTime:a}}};const pt=(0,y.Z)(dt,[["render",Ke]]);var mt=pt;function ft(e,t,a,n,o,r){const i=(0,s.up)("robo-template-devices-layout");return(0,s.wg)(),(0,s.j4)(i,{config:a.config,datalog:n.data,updateTime:n.updateTime},null,8,["config","datalog","updateTime"])}var vt=a(71561),wt=a(5800),ht=a(64071),gt=a(5492),yt=a(82373),bt=a(10055),kt=a(57993),St=a(86614),_t=a(68816),Ut=a(4521),Wt=a(76046),xt=a(92672);function It(){return e=>{async function t(e){return(0,Ut.z)(e,(async function(e){let t="";for await(const a of e)t+=(0,xt.B)(a.subarray());return JSON.parse(t)}))}async function a(e,t){return(0,Ut.z)([(0,Wt.m)(JSON.stringify(t))],e.sink).finally((()=>{e.close()}))}return{async handle(a,n,o={runOnTransientConnection:!0}){await e.registrar.handle(a,(async({stream:e})=>{n(await t(e),e)}),o)},async request(e,t,a,n={runOnTransientConnection:!0}){if("open"!==e.status)return;const o=await e.newStream([t],n);return(0,Ut.z)([(0,Wt.m)(JSON.stringify(a))],o,(async function(e){let t="";for await(const n of e)t+=(0,xt.B)(n.subarray());try{return JSON.parse(t)}catch(a){return t}}))},utils:{getRequest:t,sendResponse:a}}}}async function Rt(){const e=await(0,_t.N)({addresses:{listen:["/webrtc"]},transports:[(0,bt.E)({filter:kt.$6}),(0,yt.Z)(),(0,wt.f)()],streamMuxers:[(0,gt.R)()],connectionEncryption:[(0,vt.t)()],services:{identify:(0,ht.y)(),ha:It()},connectionGater:{denyDialMultiaddr:()=>!1},connectionManager:{minConnections:0}});return e}function At(e){return(0,St.HM)(`/dns4/libp2p-relay-1.robonomics.network/tcp/443/wss/p2p/12D3KooWEMFXXvpZUjAuj1eKR11HuzZTCQ5HmYG9MNPtsnqPSERD/p2p-circuit/p2p/${e}`)}async function Pt(e,t){if(t.length>0){const e=[],n=[];for(const a of t){const t=(0,St.HM)(a),o=t.protoNames();(o.includes("ws")||o.includes("wss"))&&(o.includes("p2p-circuit")?n.push(t):("https:"!==window.location.protocol||o.includes("wss"))&&e.push(t))}if(e.length>0)for(const t of e)try{return await $t(t),t}catch(a){console.log(a)}if(n.length>0)for(const t of n)try{return await $t(t),t}catch(a){console.log(a)}}try{const t=At(e);return await $t(t),t}catch(a){console.log(a)}return!1}let Ot=null,Ct=[],Mt=null;async function Ht(){if(Ot)return Ot;function e(){Ct=Ot.getConnections().map((e=>e.remoteAddr.toString())),console.log("Update Connections List",Ct)}return Ot=await Rt(),await Ot.start(),console.log(`Node started with id ${Ot.peerId.toString()}`),Ot.addEventListener("connection:open",(t=>{console.log("connected",t.detail.remoteAddr.toString()),e()})),Ot.addEventListener("connection:close",(t=>{console.log("disconected",t.detail.remoteAddr.toString()),e(),setTimeout((()=>{Mt&&t.detail.remoteAddr.toString()===Mt.remoteAddr.toString()&&(console.log("reconnect"),Nt(Mt.remoteAddr.toString()))}),1e4)})),Ot}async function Nt(e){try{await $t(e)}catch(t){console.log(t)}}async function $t(e){if(console.log("connect to",e.toString()),!Ct.includes(e)){const t=(0,St.HM)(e);Mt=await Ot.dial(t)}return e}async function jt(){Mt&&await Mt.close(),Mt=null}function Tt(e,t="/call"){if(Ot&&Mt)return Ot.services.ha.request(Mt,t,e);throw new Error("error")}const Dt=()=>{const e=(0,h.iH)(null),t=(0,h.iH)(null),a=(0,A.oR)(),{accountManager:n}=W(),o=x(),{controller:r}=st();(0,s.YP)((()=>a.state.robonomicsUIvue.rws.active),(()=>{o.owner.value=a.state.robonomicsUIvue.rws.active}),{immediate:!0}),(0,s.Ah)((()=>{jt()}));const i=async(o,s)=>{const i=await Ht();try{it(a,`Connect to peer id ${o}`);const c=await Pt(o,s);if(c){it(a,"Connected");const o=i.getProtocols();return o.includes("/update")&&await i.unhandle("/update"),i.services.ha.handle("/update",(async(o,s)=>{const c=await nt(o.data,r.value,n.encryptor());c?(e.value=c,t.value=Date.now(),await i.services.ha.utils.sendResponse(s,{result:!0})):it(a,"Error: decryptMsg")})),c}}catch(c){it(a,`Error: ${c.message}`),console.log(c)}return!1},c=async e=>{if(console.log(e.launch.params.entity_id,e.tx.tx_status),"pending"===e.tx.tx_status){if(it(a,"Launch command"),!o.devices.value.includes(n.account.address))return it(a,"Error: You do not have access to device management."),void ct(a,e,"error");try{const t=n.encryptor(),o=(0,Me.m)(r.value),s=JSON.stringify(e.launch),i=t.encryptMessage(s,o),c=await Tt({data:{sender:n.account.address,data:(0,ie.c)(i)}});console.log("response:",c),ct(a,e,"success")}catch(t){console.log(t),it(a,"Error: Check status of the HomeAssistant."),ct(a,e,"error")}}};return{data:e,updateTime:t,run:i,launch:c}};var Et={props:{isKey:{default:!1,type:Boolean},config:{default:null,type:Object}},emits:["connected","error"],setup(e,{emit:t}){const{data:a,updateTime:n,run:o,launch:r}=Dt(),i=(0,A.oR)(),c=e.isKey&&null!==e.config,l=(0,s.YP)((()=>[e.isKey,e.config]),(([e,a])=>{e&&null!==a&&(c||"function"!==typeof l||l(),a.peer_id?(async()=>{const e=await o(a.peer_id,a.libp2p_multiaddress);if(e)if(t("connected",e),e.protoNames().includes("p2p-circuit"))console.log("relay");else{const t=`http://${e.nodeAddress().address}:8080/ipfs/`;i.state.robonomicsUIvue.ipfs.activegateway!==t&&(console.log("set local gateway",t),i.commit("ipfs/setActiveGateway",t))}else t("error",new Error("connect"))})():t("error",new Error("not found peer_id")))}),{immediate:!0,once:c});return(0,s.YP)((()=>i.state.robonomicsUIvue.rws.launch),(e=>{try{r(JSON.parse(e))}catch(t){console.log(t)}})),{data:a,updateTime:n}}};const Yt=(0,y.Z)(Et,[["render",ft]]);var Lt=Yt,Ft={components:{Libp2p:Lt,Launch:mt},setup(){const e=(0,A.oR)(),{isReady:t,accountManager:a}=W(),{config:n,load:o}=lt(),r=(0,h.iH)(!1),i=(0,h.iH)("libp2p");return(0,s.Ah)((async()=>{if(t.value&&r.value&&e.state.robonomicsUIvue.polkadot.address!==a.account.address){const t=e.state.robonomicsUIvue.polkadot.accounts.find((t=>t.address===e.state.robonomicsUIvue.polkadot.address));t&&await a.setSender(t.address,{type:t.type,extension:e.state.robonomicsUIvue.polkadot.extensionObj})}})),(0,s.YP)((()=>e.state.robonomicsUIvue.rws.user.key),(async e=>{e?(await a.addPair(e),r.value=!0,o()):console.log("NOT KEY")}),{immediate:!0}),{type:i,isKey:r,config:n,handlerConnected:t=>{e.dispatch("app/setlibp2p",{connected:!0});let a=!1;t.protoNames().includes("p2p-circuit")&&(a=!0),e.dispatch("app/setrelay",{connected:a})},handlerError:t=>{console.log(t.message),console.log("switch to parachain"),i.value="parachain",e.dispatch("app/setlibp2p",{connected:!1}),e.dispatch("app/setrelay",{connected:!1})}}}};const zt=(0,y.Z)(Ft,[["render",Be]]);var Bt=zt;const Kt=[{path:"/",name:"Home",component:ke,meta:{title:"Dashboard"}},{path:"/rws-buy",name:"rwsActivate",component:Oe,meta:{title:"Buy a Subscription"}},{path:"/rws-setup",name:"rwsSetup",component:$e,meta:{title:"Setup a Subscription"}},{path:"/rws-setup-new",name:"rwsSetupNew",component:Ee,meta:{title:"New Subscription setup"}},{path:"/telemetry",name:"telemetry",component:Bt,meta:{title:"Devices control panel"}},{path:"/services",name:"services",component:ze,meta:{title:"Services"}},{path:"/:pathMatch(.*)*",component:Ue}],Jt=(0,M.p7)({history:(0,M.r5)(),routes:Kt});var Zt=Jt;const Gt=(0,A.MT)({state:{name:"Vue"}});var qt=Gt,Xt={install:e=>{e.config.globalProperties.$filters={balance(e,t,a){return"string"===typeof e||"number"===typeof e?`${f(e,t,4)} ${a}`:""}}}};window.Buffer=n.lW,v();const Vt=(0,r.ri)($);Vt.use(Zt).use(qt).use(Xt).use(de).use(D,{api:{gateway:"https://ipfs.url.today"},gateways:["https://ipfs.url.today/ipfs/","https://cf-ipfs.com/ipfs/","https://ipfs.io/ipfs/","https://gateway.pinata.cloud/ipfs/","https://gateway.ipfs.io/ipfs/","https://aira.mypinata.cloud/ipfs/"]}).use(o.$,{store:qt}).mount("#app")},95856:function(){},46601:function(){},42480:function(){},63897:function(){},55024:function(){}},t={};function a(n){var o=t[n];if(void 0!==o)return o.exports;var r=t[n]={id:n,loaded:!1,exports:{}};return e[n].call(r.exports,r,r.exports,a),r.loaded=!0,r.exports}a.m=e,function(){a.amdO={}}(),function(){var e=[];a.O=function(t,n,o,r){if(!n){var s=1/0;for(u=0;u<e.length;u++){n=e[u][0],o=e[u][1],r=e[u][2];for(var i=!0,c=0;c<n.length;c++)(!1&r||s>=r)&&Object.keys(a.O).every((function(e){return a.O[e](n[c])}))?n.splice(c--,1):(i=!1,r<s&&(s=r));if(i){e.splice(u--,1);var l=o();void 0!==l&&(t=l)}}return t}r=r||0;for(var u=e.length;u>0&&e[u-1][2]>r;u--)e[u]=e[u-1];e[u]=[n,o,r]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){var e,t=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__};a.t=function(n,o){if(1&o&&(n=this(n)),8&o)return n;if("object"===typeof n&&n){if(4&o&&n.__esModule)return n;if(16&o&&"function"===typeof n.then)return n}var r=Object.create(null);a.r(r);var s={};e=e||[null,t({}),t([]),t(t)];for(var i=2&o&&n;"object"==typeof i&&!~e.indexOf(i);i=t(i))Object.getOwnPropertyNames(i).forEach((function(e){s[e]=function(){return n[e]}}));return s["default"]=function(){return n},a.d(r,s),r}}(),function(){a.d=function(e,t){for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){a.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){var e={143:0};a.O.j=function(t){return 0===e[t]};var t=function(t,n){var o,r,s=n[0],i=n[1],c=n[2],l=0;if(s.some((function(t){return 0!==e[t]}))){for(o in i)a.o(i,o)&&(a.m[o]=i[o]);if(c)var u=c(a)}for(t&&t(n);l<s.length;l++)r=s[l],a.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return a.O(u)},n=self["webpackChunkdapp_robonomics_network"]=self["webpackChunkdapp_robonomics_network"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=a.O(void 0,[998],(function(){return a(53675)}));n=a.O(n)})();
//# sourceMappingURL=app.0aca9b62.js.map