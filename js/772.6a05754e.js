(self["webpackChunkdapp_robonomics_network"]=self["webpackChunkdapp_robonomics_network"]||[]).push([[772],{85629:function(e,t,n){"use strict";var o=n(3999);t.$o=c,t.XV=i,t.i3=u;var r=o(n(18654)),a=o(n(31617));function s(e,t){for(let n of Object.keys(t))Object.prototype.hasOwnProperty.call(e,n)&&"object"===typeof t[n]?s(e[n],t[n]):e[n]=t[n];return e}function i(e){const t=Buffer.from(e.slice(2),"hex"),n=a.default.multihash.encode(t,"sha2-256"),o=new r.default(0,"dag-pb",n);return o.toString()}function c(e){return"0x"+Buffer.from(a.default.multihash.decode(new r.default(e).multihash).digest).toString("hex")}function u(e){const t=Buffer.from(e.toString(),"utf-8");if(t.length>32)throw new Error("max 32");const n=Buffer.alloc(32),o=Buffer.concat([n,t]),r=Buffer.from(o).slice(o.length-32,o.length);return"0x"+r.toString("hex")}function l(e){return Buffer.from(e.slice(2),"hex").toString()}},77373:function(e,t,n){"use strict";n.d(t,{$q:function(){return b},AY:function(){return v},Iu:function(){return y},Lm:function(){return g},Ln:function(){return k},QJ:function(){return p},cN:function(){return m},tv:function(){return f}});n(44114),n(14603),n(47566),n(98721);var o=n(82169),r=n(15372),a=n(20688),s=n(74300),i=n(11817),c=n(85629),u=n(90144),l=n(56768);const d=(e,t,n)=>{const r=localStorage.getItem("rpc-parachain")||o.A.default_rpc_endpoint;localStorage.setItem(`twins:${new URL(r).host}:${e}`,JSON.stringify({total:t,twins:n}))},f=e=>{const t=localStorage.getItem("rpc-parachain")||o.A.default_rpc_endpoint;try{const n=JSON.parse(localStorage.getItem(`twins:${new URL(t).host}:${e}`));if(n)return n}catch(n){console.log(n)}return{total:!1,twins:[]}},g=async e=>await e.twin.getTotal(),w=async(e,t,n=0)=>{const o=[],r=await g(e);for(let a=n;a<r;a++){const n=await e.twin.getOwner(a);n===t&&o.push(a)}return{total:r,twins:o}},p=async(e,t)=>{const{total:n,twins:o}=await w(e,t);return d(t,n,o),o},v=e=>(e=e.replace(/^0x/,"").replace(/^00+/,""),e.length%2!==0&&(e="0"+e),Buffer.from(e,"hex").toString("utf8")),k=e=>(0,c.XV)(e);function y(e){const{getInstance:t}=(0,s.x)(),n=(0,u.KR)();return(0,l.wB)(e,(async e=>{if(e>=0){const o=t();n.value=await o.twin.getTwin(e)}}),{immediate:!0}),{twin:n}}function b(e=!1){const{isReady:t,getInstance:n}=(0,s.x)(),{account:o}=(0,r.F)(),a=(0,u.KR)(),i=(0,u.KR)(!1),c=async e=>{const t=n(),o=f(e);let r=0;if(!1!==o.total){const e=await g(t);if(e===o.total)return void(a.value=o.twins);r=o.total}a.value=await p(t,e,r)},d=()=>{(0,l.wB)([o,t],(async([e,t])=>{e&&t&&(i.value=!0,await c(e),i.value=!1)}),{immediate:!0})};return e&&d(),{twins:a,isLoading:i,run:d}}function m(){const{getInstance:e}=(0,s.x)(),t=(0,i.q)(),{account:n}=(0,r.F)(),o=(0,a.t)(n),u=async()=>{const r=e(),a=r.twin.create(),s=t.createTx();return o.devices.value.includes(n.value)?await t.send(s,a,n.value):await t.send(s,a),s},l=async(r,a,s)=>{const i=e();let u;try{u=(0,c.$o)(a)}catch(f){u=(0,c.i3)(a)}const l=i.twin.setSource(r,u,s),d=t.createTx();return o.devices.value.includes(n.value)?await t.send(d,l,n.value):await t.send(d,l),d};return{create:u,setSource:l}}},93772:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return O}});var o=n(56768);function r(e,t,n,r,a,s){const i=(0,o.g2)("robo-section"),c=(0,o.g2)("d-twin"),u=(0,o.g2)("robo-layout-section");return(0,o.uX)(),(0,o.Wv)(u,null,{default:(0,o.k6)((()=>[(0,o.bF)(i,{offset:"x2",width:"narrow",style:{"text-align":"center"}},{default:(0,o.k6)((()=>t[0]||(t[0]=[(0,o.Lk)("h2",null,"Digital Twin",-1)]))),_:1}),(0,o.bF)(i,{offset:"x2",width:"narrow"},{default:(0,o.k6)((()=>[(0,o.bF)(c)])),_:1})])),_:1})}function a(e,t,n,r,a,s){const i=(0,o.g2)("select-twin"),c=(0,o.g2)("create-twin"),u=(0,o.g2)("robo-grid"),l=(0,o.g2)("robo-section"),d=(0,o.g2)("twin-records"),f=(0,o.g2)("form-source");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.bF)(l,{offset:"x05"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{offset:"x0",gap:"x05",columns:"1"},{default:(0,o.k6)((()=>[((0,o.uX)(),(0,o.Wv)(i,{onChange:t[0]||(t[0]=e=>r.twinId=e),key:r.keySelect})),(0,o.bF)(c,{onCreate:t[1]||(t[1]=e=>r.keySelect++)})])),_:1})])),_:1}),r.twinId>=0?((0,o.uX)(),(0,o.Wv)(l,{key:0,offset:"x2"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{offset:"x0",gap:"x05",columns:"1"},{default:(0,o.k6)((()=>[((0,o.uX)(),(0,o.Wv)(d,{id:r.twinId,key:r.keyRecords},null,8,["id"])),(0,o.bF)(f,{id:r.twinId,onCreate:t[2]||(t[2]=e=>r.keyRecords++)},null,8,["id"])])),_:1})])),_:1})):(0,o.Q3)("",!0)],64)}var s=n(90144);function i(e,t,n,r,a,s){const i=(0,o.g2)("robo-button");return(0,o.uX)(),(0,o.Wv)(i,{onClick:r.create,block:"",disabled:r.isProccess,loading:r.isProccess,type:r.isSuccess?"ok":"primary"},{default:(0,o.k6)((()=>t[0]||(t[0]=[(0,o.eW)(" Create new ")]))),_:1},8,["onClick","disabled","loading","type"])}var c=n(77373),u={emits:["change"],setup(e,{emit:t}){const{create:n}=(0,c.cN)(),o=(0,s.KR)(!1),r=(0,s.KR)(!1);return{isProccess:o,isSuccess:r,create:async()=>{r.value=!1,o.value=!0;const e=await n();if(e.error.value)return"Cancelled"!==e.error.value?console.log(e.error.value):console.log("cancel"),o.value=!1,!1;o.value=!1,r.value=!0,t("create")}}}},l=n(71241);const d=(0,l.A)(u,[["render",i]]);var f=d;function g(e,t,n,r,a,s){const i=(0,o.g2)("robo-text"),c=(0,o.g2)("robo-input"),u=(0,o.g2)("robo-button"),l=(0,o.g2)("robo-grid"),d=(0,o.g2)("robo-section");return(0,o.uX)(),(0,o.Wv)(d,{offset:"x05"},{default:(0,o.k6)((()=>[(0,o.bF)(l,{offset:"x0",gap:"x05",columns:"1"},{default:(0,o.k6)((()=>[(0,o.bF)(i,{title:"3",offset:"x0"},{default:(0,o.k6)((()=>t[2]||(t[2]=[(0,o.eW)("Add source")]))),_:1}),(0,o.bF)(c,{modelValue:r.topic,"onUpdate:modelValue":t[0]||(t[0]=e=>r.topic=e),label:"Topic",block:""},null,8,["modelValue"]),(0,o.bF)(c,{modelValue:r.source,"onUpdate:modelValue":t[1]||(t[1]=e=>r.source=e),label:"Source",block:""},null,8,["modelValue"]),(0,o.bF)(u,{onClick:r.setSource,block:"",disabled:r.isProccess,loading:r.isProccess,type:r.isSuccess?"ok":"primary"},{default:(0,o.k6)((()=>t[3]||(t[3]=[(0,o.eW)(" Save ")]))),_:1},8,["onClick","disabled","loading","type"])])),_:1})])),_:1})}var w={props:["id"],setup(e,{emit:t}){const{setSource:n}=(0,c.cN)(),o=(0,s.KR)(),r=(0,s.KR)(),a=(0,s.KR)(!1),i=(0,s.KR)(!1);return{topic:o,source:r,isProccess:a,isSuccess:i,setSource:async()=>{i.value=!1,a.value=!0;const s=await n(e.id,o.value,r.value);if(s.error.value)return"Cancelled"!==s.error.value?console.log(s.error.value):console.log("cancel"),a.value=!1,!1;a.value=!1,i.value=!0,t("create")}}}};const p=(0,l.A)(w,[["render",g]]);var v=p;function k(e,t,n,r,a,s){const i=(0,o.g2)("robo-select"),c=(0,o.g2)("robo-status"),u=(0,o.g2)("robo-loader"),l=(0,o.g2)("robo-text");return(0,o.uX)(),(0,o.CE)(o.FK,null,[void 0!==r.twins&&r.twins.length>0?((0,o.uX)(),(0,o.Wv)(i,{key:0,options:r.twins,values:r.twins,modelValue:r.twinId,"onUpdate:modelValue":t[0]||(t[0]=e=>r.twinId=e),size:"small",label:"Choose digital twin",block:""},null,8,["options","values","modelValue"])):void 0===r.twins||r.isLoading?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(c,{key:1,type:"warning"},{default:(0,o.k6)((()=>t[1]||(t[1]=[(0,o.eW)(" Digital twins do not exist ")]))),_:1})),r.isLoading?((0,o.uX)(),(0,o.Wv)(l,{key:2,weight:"normal-italic",align:"center"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{size:"1.5"}),t[2]||(t[2]=(0,o.eW)(" Loading "))])),_:1})):(0,o.Q3)("",!0)],64)}var y={emits:["change"],setup(e,{emit:t}){const{twins:n,isLoading:r}=(0,c.$q)(!0),a=(0,s.KR)();return(0,o.wB)(n,(e=>{void 0===a.value&&e&&e.length>0&&(a.value=e[e.length-1])}),{immediate:!0}),(0,o.wB)(a,(e=>{t("change",e)})),{twins:n,twinId:a,isLoading:r}}};const b=(0,l.A)(y,[["render",k]]);var m=b;const h={key:0};function x(e,t,n,r,a,s){const i=(0,o.g2)("twin-record"),c=(0,o.g2)("robo-status");return r.twin?((0,o.uX)(),(0,o.CE)("div",h,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.twin,((e,t)=>((0,o.uX)(),(0,o.Wv)(i,{key:t,token:t,address:e},null,8,["token","address"])))),128))])):((0,o.uX)(),(0,o.Wv)(c,{key:1,type:"warning"},{default:(0,o.k6)((()=>t[0]||(t[0]=[(0,o.eW)("No entries")]))),_:1}))}var _=n(24232);const C={class:"record"},S={class:"type"},R={class:"token"},X={key:0},F={key:1},W={key:2};function I(e,t,n,r,a,s){const i=(0,o.g2)("router-link");return(0,o.uX)(),(0,o.CE)("div",C,[(0,o.Lk)("div",S,[(0,o.Lk)("button",{class:(0,_.C4)({active:"hex"===r.type}),onClick:t[0]||(t[0]=e=>r.type="hex")}," hex ",2),(0,o.Lk)("button",{class:(0,_.C4)({active:"ipfs"===r.type}),onClick:t[1]||(t[1]=e=>r.type="ipfs")}," ipfs ",2),(0,o.Lk)("button",{class:(0,_.C4)({active:"text"===r.type}),onClick:t[2]||(t[2]=e=>r.type="text")}," text ",2)]),(0,o.Lk)("div",R,["hex"===r.type?((0,o.uX)(),(0,o.CE)("span",X,(0,_.v_)(n.token),1)):(0,o.Q3)("",!0),"ipfs"===r.type?((0,o.uX)(),(0,o.CE)("span",F,(0,_.v_)(r.tokenToCid(n.token)),1)):(0,o.Q3)("",!0),"text"===r.type?((0,o.uX)(),(0,o.CE)("span",W,(0,_.v_)(r.tokenToString(n.token)),1)):(0,o.Q3)("",!0)]),(0,o.Lk)("div",null,(0,_.v_)(n.address),1),"0x000000000000000000000000000000000000000000000000616c747275697374"===n.token?((0,o.uX)(),(0,o.Wv)(i,{key:0,to:`/altruist/${n.address}`},{default:(0,o.k6)((()=>t[3]||(t[3]=[(0,o.eW)(" Â» altruist ")]))),_:1},8,["to"])):(0,o.Q3)("",!0)])}var L={props:["token","address"],setup(){const e=(0,s.KR)("hex");return{type:e,tokenToCid:c.Ln,tokenToString:c.AY}}};const K=(0,l.A)(L,[["render",I],["__scopeId","data-v-4d53ba22"]]);var T=K,A={props:["id"],components:{TwinRecord:T},setup(e){const{twin:t}=(0,c.Iu)((0,s.QW)(e).id);return{twin:t,tokenToCid:c.Ln,tokenToString:c.AY}}};const B=(0,l.A)(A,[["render",x]]);var V=B,E={components:{SelectTwin:m,CreateTwin:f,TwinRecords:V,FormSource:v},setup(){return{twinId:(0,s.KR)(),keySelect:(0,s.KR)(0),keyRecords:(0,s.KR)(0)}}};const Q=(0,l.A)(E,[["render",a]]);var $=Q,P={components:{DTwin:$}};const N=(0,l.A)(P,[["render",r]]);var O=N},3999:function(e){function t(e){return e&&e.__esModule?e:{default:e}}e.exports=t,e.exports.__esModule=!0,e.exports["default"]=e.exports}}]);
//# sourceMappingURL=772.6a05754e.js.map