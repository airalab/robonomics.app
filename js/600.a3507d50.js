"use strict";(self["webpackChunkdapp_robonomics_network"]=self["webpackChunkdapp_robonomics_network"]||[]).push([[600],{16115:function(e,t,a){a.r(t),a.d(t,{default:function(){return $}});var l=a(98473);const n=(0,l._)("h2",null,"Energy Monitor",-1);function o(e,t,a,o,s,r){const u=(0,l.up)("robo-section"),d=(0,l.up)("datalog-loader"),i=(0,l.up)("robo-status"),c=(0,l.up)("energy-chart"),f=(0,l.up)("notice-text"),p=(0,l.up)("robo-layout-section");return(0,l.wg)(),(0,l.j4)(p,null,{default:(0,l.w5)((()=>[(0,l.Wm)(u,{offset:"x2",width:"middle",style:{"text-align":"center"}},{default:(0,l.w5)((()=>[n])),_:1}),(0,l.Wm)(u,{offset:"x2",width:"middle"},{default:(0,l.w5)((()=>[o.isFind?((0,l.wg)(),(0,l.j4)(d,{key:0})):null===o.energyAddress?((0,l.wg)(),(0,l.j4)(i,{key:1,type:"warning"},{default:(0,l.w5)((()=>[(0,l.Uk)(" Not found ")])),_:1})):void 0!==o.energyAddress?((0,l.wg)(),(0,l.j4)(c,{key:2,address:o.energyAddress},null,8,["address"])):(0,l.kq)("",!0)])),_:1}),(0,l.Wm)(u,{offset:"x2",width:"middle"},{default:(0,l.w5)((()=>[(0,l.Wm)(f)])),_:1})])),_:1})}var s=a(97710),r=a(17898),u=a(38966);const d={key:0};function i(e,t,a,n,o,s){const r=(0,l.up)("datalog-chart"),u=(0,l.up)("sensor-info"),i=(0,l.up)("last-data"),c=(0,l.up)("datalog-loader");return n.isLaoded?((0,l.wg)(),(0,l.iD)("div",d,[(0,l.Wm)(r,{log:n.log},null,8,["log"]),(0,l.Wm)(u,{sensor_id:a.address,class:"block"},null,8,["sensor_id"]),(0,l.Wm)(i,{data:n.log[n.log.length-1],class:"block"},null,8,["data"])])):((0,l.wg)(),(0,l.j4)(c,{key:1}))}var c=a(64188),f=a(96524),p=a(37839);function g(e,t,a,n,o,s){const r=(0,l.up)("chart");return(0,l.wg)(),(0,l.j4)(r,{options:n.chartOptions,ref:"chart"},null,8,["options"])}a(57658);var m=a(1898),y={label:"Active power",unit:"W"},v={label:"Current",unit:"A"},w={label:"Energy today",unit:"kWh"},h={label:"Energy total",unit:"kWh"},b={label:"Voltage",unit:"V"},_={label:"Energy yesterday",unit:"kWh"},k={daily:w,voltage:b,active_power:y,yesterday_sum:_,current:v,total:h},x={components:{Chart:m.Chart},props:["log"],setup(e){const t=e=>{const t={};for(const a of e)for(const e of a.data)if(t[e.fullKey])t[e.fullKey].data.push([a.moment,parseFloat(e.value)]);else{let l=e.fullKey;k[e.fullKey]&&k[e.fullKey].label&&(l=k[e.fullKey].label),t[e.fullKey]={name:l,data:[[a.moment,parseFloat(e.value)]],tooltip:{valueSuffix:` ${k[e.fullKey].unit??""}`}}}return Object.values(t)},a=t(e.log);let n;return(0,l.bv)((()=>{n=(0,l.FN)().refs.chart.chart})),(0,l.YP)(e.log,(e=>{if(!n)return;const a=t(e);a.length>0&&(a.forEach((e=>{const t=n.series.findIndex((t=>t.name===e.name));t>=0?n.series[t].setData(e.data,!1):n.addSeries(e)})),n.redraw())})),{chartOptions:{lang:{locale:"en"},chart:{spacing:[50,20,20,20]},title:{text:""},time:{timezone:Intl.DateTimeFormat().resolvedOptions().timeZone},xAxis:{title:!1,type:"datetime",labels:{overflow:"justify",format:"{value: %H:%M }"}},yAxis:{title:!1},tooltip:{valueDecimals:2},series:a}}}},D=a(25312);const K=(0,D.Z)(x,[["render",g]]);var W=K,Z=a(24887);const j={class:"infoline flexline"},A={class:"infoline-info"};function F(e,t,a,n,o,s){return(0,l.wg)(),(0,l.iD)("section",null,[(0,l._)("h3",null,"Last data "+(0,Z.zw)(new Date(a.data.moment).toLocaleString()),1),(0,l._)("div",j,[(0,l._)("div",A,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(n.measurements,((e,t)=>((0,l.wg)(),(0,l.iD)("div",{class:"datalog-item",key:t},[(0,l._)("b",null,(0,Z.zw)(e.label)+":",1),(0,l.Uk)(" "+(0,Z.zw)(e.value),1)])))),128))])])])}function L(e){return k[e]||{label:e}}var C={props:["data"],setup(e){const t=[];for(const a of e.data.data){const e=L(a.fullKey);t.push({...e,value:`${e.calculate?e.calculate(a.value):a.value} ${e.unit??""}`})}return{measurements:t}}};const E=(0,D.Z)(C,[["render",F],["__scopeId","data-v-0cba4dcc"]]);var I=E;const S=e=>{try{const t=[],a=JSON.parse(e);for(const e in a){const l=a[e];t.push({key:e,fullKey:e,value:l})}return t}catch(t){console.log(t)}};var O={props:["address"],components:{DatalogLoader:s.Z,DatalogChart:W,SensorInfo:f.Z,LastData:I},setup(e){const t=(0,p.I)((0,c.BK)(e).address,S),a=(0,c.iH)(!1),l=()=>{a.value=!a.value};return{log:t.log,isLaoded:t.isLaoded,isShowRaw:a,showRaw:l}}};const z=(0,D.Z)(O,[["render",i],["__scopeId","data-v-2c9d01bc"]]);var N=z,H={props:["address"],components:{EnergyChart:N,DatalogLoader:s.Z,NoticeText:r.Z},setup(e){const{address:t,isFind:a,runFind:n}=(0,u.p)("0x000000000000000000000000000000000000000000000000616c747275697374");return(0,l.YP)((()=>e.address),(e=>{e?t.value=e:n()}),{immediate:!0}),{energyAddress:t,isFind:a}}};const Y=(0,D.Z)(H,[["render",o]]);var $=Y}}]);
//# sourceMappingURL=600.a3507d50.js.map